# ğŸ€ NBA Player Stat Prediction

Predict NBA player game stats (points, rebounds, assists, steals, blocks, and three-pointers made) to help gain an edge in sports betting.

Built with advanced machine learning techniques, clustering, feature selection, model stacking, and served via a Shiny App for easy interaction.

---

## ğŸ“ˆ Project Overview

- **Goal:** Predict NBA player performance for upcoming games.
- **Use Cases:** 
  - Sports betting edge
  - Daily Fantasy Sports (DFS) projections
  - Basketball analytics research
- **Target Stats Predicted:**
  - Points
  - Rebounds
  - Assists
  - Steals
  - Blocks
  - 3PT Field Goals Made

---

## ğŸ”¥ Key Methods

- **Data Preparation:**
  - Raw NBA gamelogs from the 2022 season onwards
  - Only players with â‰¥10 games and â‰¥20 minutes/game included
  - Rolling averages, momentum features, team offense/defense rankings
  
- **Feature Engineering:**
  - Rolling 10-game statistics
  - Player momentum indicators
  - Win streak and loss streak tracking
  - Opponent defensive efficiency
  - Safe handling of missing values

- **Dimensionality Reduction & Clustering:**
  - Principal Component Analysis (PCA) for player profile compression
  - Temporally split and aggregated gamelogs by player for clustering
  - KMeans clustering with K=3 (optimal K selected via elbow and silhouette methods)
  - Cluster labels used as additional model features
  - 3 clusters achieved best silhouette score of 0.40

- **Feature Selection:**
  - MultiTask Lasso Regression (`MultiTaskLasso`) for shrinkage and selection
  - Only features with non-zero coefficients retained

- **Model Stacking:**
  - Base model: MultiTask Lasso Regression (continuous predictions)
  - Classification layer: Random Forest Classifier (`MultiOutputClassifier`) to predict binned outcomes
  - Final model: Random Forest Regressor (`MultiOutputRegressor`) trained on stacked features + predictions

- **Evaluation Metrics:**
  - RÂ² Score
  - RMSE (Root Mean Squared Error)
  - MAE (Mean Absolute Error)
  - Precision, Recall, F1 for classification tasks
  
- **Baseline Comparison:**
  - Compared against a naive model predicting mean outcomes for each stat

---

## ğŸš€ Shiny App

A custom [**Shiny App**](https://jmotta31.shinyapps.io/NBA_Prediction_Tool/) was built to make predictions easily accessible!

**Shiny App Features:**

- ğŸ“ˆ **Prediction Table:**  
  Dynamic `reactable` table listing player predictions for upcoming games.
  
- ğŸ¯ **Implied Probability Calculator:**  
  Input the **American Odds** for a player prop to automatically compute:
  - Implied probability
  - Whether the model's projection suggests an edge.

- ğŸ“Š **Model Metrics Dashboard:**  
  Displaying final model evaluation metrics across targets.

---

## ğŸ› ï¸ Tech Stack

- **Languages:** Python 3.11, R (for Shiny)
- **Libraries:**
  - `scikit-learn`, `pandas`, `numpy`, `seaborn`, `plotly`, `nba_api`
  - `joblib` (for model persistence)
  - `shiny`, `reactable`, `dplyr`, `tidyverse` (in the R Shiny App)

---

## ğŸ“‚ Project Structure

```bash
NBA_Stat_Pred/
â”œâ”€â”€ NBA_Stat_Pred.py             # Main Python training and prediction pipeline
â”œâ”€â”€ nba_predictions.py           # Python script to generate predictions for upcoming games
â”œâ”€â”€ update_nba_data.R            # R script to update input data
â”œâ”€â”€ nba_gamelogs.parquet         # Input data
â”œâ”€â”€ nba_schedule.parquet         # Upcoming games data
â”œâ”€â”€ Pivoted_Betting_Odds.parquet # Data obtained from Odds API containing players with upcoming props
â”œâ”€â”€ evaluation_metrics.parquet   # Final model metrics used in Shiny app
â”œâ”€â”€ app.R                        # R Shiny App
â”œâ”€â”€ www/                         # Shiny app images generated by Dall-E
â””â”€â”€ README.md                    # This file
